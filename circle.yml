machine:
  environment:
    MOCHA_FILE: $CIRCLE_TEST_REPORTS/test-results.xml
    ESLINT_FILE: $CIRCLE_TEST_REPORTS/eslint-results.xml
dependencies:
  pre:
    - npm install -g npm@3
test:
  post:
    - cp test/artifacts/* $CIRCLE_ARTIFACTS/
    - npm run coverage:html -- --report-dir $CIRCLE_ARTIFACTS/coverage
    - npm run coverage:codecov && bash <(curl -s https://codecov.io/bash)
deployment:
  prod:
    branch: master
    commands:
      - npm run semantic-release
checkout:
  post:
    - git submodule sync --recursive
    - git submodule update --recursive --init
